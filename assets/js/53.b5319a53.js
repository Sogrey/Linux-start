(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{371:function(t,s,a){"use strict";a.r(s);var e=a(14),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"chattr-改变文件的属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chattr-改变文件的属性"}},[t._v("#")]),t._v(" chattr - 改变文件的属性")]),t._v(" "),s("p",[t._v("用来改变文件属性。这项指令可改变存放在ext2文件系统上的文件或目录属性，这些属性共有以下8种模式。")]),t._v(" "),s("p",[t._v("这个命令只有超级用户才能使用。这个指令适用于ext2、ext3、ext4、xfs、ubifs、reiserfs、jfs系统。")]),t._v(" "),s("h2",{attrs:{id:"适用范围"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用范围"}},[t._v("#")]),t._v(" 适用范围")]),t._v(" "),s("div",{staticClass:"svg redhat"},[t._v("RedHat")]),t._v(" "),s("div",{staticClass:"svg rhel"},[t._v("RHEL")]),t._v(" "),s("div",{staticClass:"svg ubuntu"},[t._v("Ubuntu")]),t._v(" "),s("div",{staticClass:"svg centos"},[t._v("CentOS")]),t._v(" "),s("div",{staticClass:"svg debian"},[t._v("Debian")]),t._v(" "),s("div",{staticClass:"svg deepin"},[t._v("Deepin")]),t._v(" "),s("div",{staticClass:"svg suse"},[t._v("SUSE")]),t._v(" "),s("div",{staticClass:"svg opensuse"},[t._v("openSUSE")]),t._v(" "),s("div",{staticClass:"svg fedora"},[t._v("Fedora")]),t._v(" "),s("div",{staticClass:"svg linuxmint"},[t._v("Linux Mint")]),t._v(" "),s("div",{staticClass:"svg alpinelinux"},[t._v("Alpine Linux")]),t._v(" "),s("div",{staticClass:"svg archlinux"},[t._v("Arch Linux")]),t._v(" "),s("h2",{attrs:{id:"语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[t._v("#")]),t._v(" 语法")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("chattr  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-RVf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" version "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  + "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" - "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("属性"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v("\n")])])]),s("p",[t._v("运算符‘+‘使所选属性被添加到文件的现有属性中；’-’使它们被删除；‘=’使它们成为文件所拥有的唯一属性。")]),t._v(" "),s("h2",{attrs:{id:"选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-R")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 递归的方式修改目录及其子目录下的文件属性")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-V")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 显示详细执行过程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 跳过错误信息")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" version    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置文件或者目录的版本号")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 属性")]),t._v("\na             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只能以append的方式打开")]),t._v("\nA             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最后修改时间不被记录")]),t._v("\nc             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对文件进行压缩，而读取的时候会得到解压数据")]),t._v("\nD             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 同步目录更新")]),t._v("\nd             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不进行备份")]),t._v("\nE             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 压缩文件有错误，这个属性不能被用户手动修改")]),t._v("\ne             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件使用扩展区来映射到磁盘")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目录使用hash树来索引，这个属性不能被用户手动修改")]),t._v("\nh             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件大小超过2TB，这个属性不能被用户手动修改")]),t._v("\ni             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件不能被修改，但是可以删除或者重命名")]),t._v("\ns             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将数据块清零并存入磁盘")]),t._v("\nS             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 同步更新。将文件修改之后，结果写入磁盘")]),t._v("\nu             "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 预防意外删除")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-T")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目录层次结构顶部")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 压缩原始存取。虽然lsattr(1)可以显示它，")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 但它目前不能使用chattr(1)进行设置或重置。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Z")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 压缩脏文件。虽然它可以由lsattr(1)显示，")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 但不能使用chattr(1)设置或重置")]),t._v("\n\n+"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("属性"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启文件或目录的该项属性；")]),t._v("\n-"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("属性"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭文件或目录的该项属性；")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("属性"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定文件或目录的该项属性。")]),t._v("\n")])])]),s("h2",{attrs:{id:"举例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#举例"}},[t._v("#")]),t._v(" 举例")]),t._v(" "),s("p",[t._v("用chattr命令防止系统中某个关键文件被修改：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sogrey@bogon 文档"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ chattr +i /etc/fstab\n/home/sogrey/文档\n")])])]),s("p",[t._v("然后试一下"),s("code",[t._v("rm")]),t._v("、"),s("code",[t._v("mv")]),t._v("、"),s("code",[t._v("rename")]),t._v("等命令操作于该文件，都是得到"),s("code",[t._v("Operation not permitted")]),t._v("的结果。")]),t._v(" "),s("p",[t._v("让某个文件只能往里面追加内容，不能删除，一些日志文件适用于这种操作：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sogrey@bogon 文档"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ chattr +a /data1/user_act.log\n/home/sogrey/文档\n")])])]),s("p",[t._v("增加a属性，设置版本号。显示详细的执行过程:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sogrey@bogon demos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ chattr "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-V")]),t._v(" +a test.txt\nchattr "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.45")]),t._v(".0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("-Mar-2019"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest.txt的标志被设为 -----a--------e-----\nchattr: 不允许的操作 设置 test.txt 的标志时\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sogrey@bogon demos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" test.c\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sogrey@bogon demos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ chattr "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Vv")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v(" +c test.c\nchattr "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.45")]),t._v(".0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("-Mar-2019"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest.c的标志被设为 --------c-----e-----\ntest.c 的版本被设置为 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sogrey@bogon demos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ \n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);