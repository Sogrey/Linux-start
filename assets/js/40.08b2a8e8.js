(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{354:function(t,a,s){"use strict";s.r(a);var e=s(14),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"arpwatch-监听网络上arp的记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#arpwatch-监听网络上arp的记录"}},[t._v("#")]),t._v(" arpwatch - 监听网络上ARP的记录")]),t._v(" "),a("p",[t._v("arpwatch命令 用来监听网络上arp的记录。")]),t._v(" "),a("p",[t._v("arpwatch指令可以监听网络设备和ip地址的对应关系，将发现的信息发送到系统日志“/var/log/message”。")]),t._v(" "),a("h2",{attrs:{id:"适用范围"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#适用范围"}},[t._v("#")]),t._v(" 适用范围")]),t._v(" "),a("div",{staticClass:"svg redhat"},[t._v("RedHat")]),t._v(" "),a("div",{staticClass:"svg rhel"},[t._v("RHEL")]),t._v(" "),a("div",{staticClass:"svg ubuntu"},[t._v("Ubuntu")]),t._v(" "),a("div",{staticClass:"svg centos"},[t._v("CentOS")]),t._v(" "),a("div",{staticClass:"svg debian"},[t._v("Debian")]),t._v(" "),a("div",{staticClass:"svg deepin"},[t._v("Deepin")]),t._v(" "),a("div",{staticClass:"svg suse"},[t._v("SUSE")]),t._v(" "),a("div",{staticClass:"svg opensuse"},[t._v("openSUSE")]),t._v(" "),a("div",{staticClass:"svg fedora"},[t._v("Fedora")]),t._v(" "),a("div",{staticClass:"svg linuxmint"},[t._v("Linux Mint")]),t._v(" "),a("div",{staticClass:"svg alpinelinux"},[t._v("Alpine Linux")]),t._v(" "),a("div",{staticClass:"svg archlinux"},[t._v("Arch Linux")]),t._v(" "),a("h2",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[t._v("#")]),t._v(" 语法")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("arpwatch  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h2",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打开调试模式，调试信息发送到终端")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置arp记录的存储文件，默认arp.dat。开始使用这个指令之前，必须创建一个空arp.dat")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" interface        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定网络接口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 说明本地网络")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-N")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -N标志禁止报告")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-r")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从指定的文件中读取arp记录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定发送mail的目标用户，默认是root")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定发送mail的源用户，默认root")]),t._v("\n")])])]),a("h2",{attrs:{id:"报告信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#报告信息"}},[t._v("#")]),t._v(" 报告信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("信息")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("new activity")])]),t._v(" "),a("td",[t._v("这对ethernet/ip地址对第一次被使用了六个月或更长时间。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("new station")])]),t._v(" "),a("td",[t._v("此ip地址以前从未使用过此以太网地址。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("flip flop")])]),t._v(" "),a("td",[t._v("以太网地址已从最近看到的地址改为第二最近看到的地址。(如果旧的或新的以太网地址是DECnet地址，并且不到24小时，则报告的电子邮件版本将被取消。)")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("changed ethernet address")])]),t._v(" "),a("td",[t._v("主机切换到新的以太网地址。")])])])]),t._v(" "),a("h2",{attrs:{id:"系统日志信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系统日志信息"}},[t._v("#")]),t._v(" 系统日志信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("信息")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("ethernet broadcast")])]),t._v(" "),a("td",[t._v("主机的mac以太网地址是广播地址。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ip broadcast")])]),t._v(" "),a("td",[t._v("主机的IP地址是广播地址。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("bogon")])]),t._v(" "),a("td",[t._v("源ip地址不是本地子网的本地地址。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ethernet broadcast")])]),t._v(" "),a("td",[t._v("源mac或arp以太网地址均为1或全部为零。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ethernet mismatch")])]),t._v(" "),a("td",[t._v("源Mac以太网地址与ARP数据包中的地址不匹配。")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("reused old ethernet address")])]),t._v(" "),a("td",[t._v("以太网地址已从最近看到的地址更改为第三(或更大)最近看得最少的地址。(这类似于触发器。)")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("suppressed DECnet flip flop")])]),t._v(" "),a("td",[t._v("由于两个地址之一是DECnet地址，“flip flop”报告被禁止。")])])])]),t._v(" "),a("h2",{attrs:{id:"举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#举例"}},[t._v("#")]),t._v(" 举例")]),t._v(" "),a("p",[t._v("监听arp信息")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ arpwatch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" eth0               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 监听网卡eht0 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" /var/log/messages    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看最近的日志信息")]),t._v("\nSep "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" 08:29:59 localhost arpwatch: listening on eth0\nSep "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" 08:30:01 localhost arpwatch: new station "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.1 c8:41:29:f4:4a:20\nSep "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" 08:30:12 localhost arpwatch: new station "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.9 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":0:27:14:33:57\nYou have new mail "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /var/spool/mail/root\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);